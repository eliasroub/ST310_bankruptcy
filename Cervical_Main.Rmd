---
title: "Cervical Cancer Main"
output: html_document
date: "2023-03-01"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

## Including Plots


```{r}
library(tidyr)
library(tidyverse)
library(visdat)
library(ggplot2)
library(broom)
library(dtplyr)
library(gapminder)
library(car)
library(leaps)
library(visdat)
library(glmnet)
```

The response variable is "Biopsy"


EDA

Data loading and dealing with missing values, outliers


```{r}
cervical_data <- read.csv("/Users/eliasroubache/Downloads/risk_factors_cervical_cancer.csv", header= TRUE) 
##upload the cervical data 
View(cervical_data) 
##visualize the cervical data in a new tab 
dim(cervical_data) 
##view the number of predictors p and the number of observations n. Here, p=35 and n=858. Search for a technique to output directly the number of predictors
glimpse(cervical_data)
##view the types of the different predictors and their first values
```

```{r}
cervical_data[cervical_data == "?"]<- NA 
##missing values in the datasets are represented by ?. They are replaced by NA, the value R matches for missing values. 
vis_miss(cervical_data)
## view the proportion of missing values for each predictor and for the whole data. 
colSums(is.na(cervical_data))
## view the number of missing data for each predictors. Search for a method that sees if the missing values are for the same observations. In this case, can we remove them? Idea: we can remove the predictors with more than 15% of the data missing.
cervical_data[is.na(cervical_data)] <- 0.0 
## arbitrarly transform the missing values by O. THIS NEEDS JUSTIFICATION.
vis_miss(cervical_data)
## check there is no more missing values. 
```




Univariate analysis 

1. Checking the types (categorical or continuous) of each predictor
2. Checking the count for each predictor

```{r}
## we see there are non numeric values in the dataset, only integers and characters. 

for (i in 1:35) {
unique(cervical_data[i])
}
## to do. Look at the difference values taken by the predictors to spot binary and categorical predictors. If there are 2 values, they are binary. All predictors that measures time are considered continuous (as time is infinite and can be split). Same argument for number of partners (it can be infinite). If the number of unique values is under 20 for other predictors, we say it is categorical. Otherwise, it is considered to be continuous.  
```

```{r}
continuous_variable_index <- c(1,2,3,4,6,7,11,27,28)
## we create a vector containing the column indices of continous predictors. 
categorical_varibales_index <- c(5,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26, 29,30,31,32,33,34,35)
## we create a vector containing the column indices of continous predictors. 
cervical_data[continuous_variable_index] <- sapply(cervical_data[continuous_variable_index],as.numeric)
## change type of continuous variable to numeric, the type of categorical variable as factors. INDEXTO BE CHANGED 
```

```{r}
cervical_data[2]
colnames(cervical_data[2])
ggplot(cervical_data) + 
    geom_hist(aes(x = Number.of )
## plot the frequency of each variable. Mark the mean and the median to assess the skewness. 
## complete the hist plots by boxplots for each variable. Good way to see outliers and skewness
## try to use ggplot package with indexing to benefit from the benefits of ggplot such as density or frequoply for the moment. A regular method is to find below. 
```




Bivariate analysis

Checking the linearity assumption

```{r}
for(i in continuous_variable_index){
  hist((cervical_data)[,i]~Biopsy, ylab = "Biopsy", xlab = colnames(cervical_data)[i], cervical_data)
}
## we use a for loop to plot a point plot of each continous predictor against the response. We then plot a line that best fit the data and check for linearity. Try to use ggplot. 
```


Checking the normality assumption

```{r}
## plot a QQ-plot. But seems to be done later because we need to build the model first and have predictions to test against the real values. 
```



```{r}
for(i in categorical_varibales_index){
  boxplot((cervical_data)[,i]~Biopsy, ylab = "Biopsy", xlab = colnames(cervical_data)[i], cervical_data)

  ## for cvategorical variable, we draw boxplot to see 
```


Building the model 

## plot the residual plot with each continuous predictors to see if the linearity assumption is satisfied. Otherwise, check for non-linear methods. 

```{r}
model_1 <- lm(Biopsy~., cervical_data)
```
